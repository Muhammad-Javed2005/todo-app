<!-- templates/dashboard.html -->
{% extends "layout.html" %}
{% block content %}
  <div class="panel">
    <div class="panel-head">
      <h2>Your Tasks</h2>
      <form method="get" action="{{ url_for('dashboard') }}" class="search-form">
        <input name="q" placeholder="Search tasks..." value="{{ q|default('') }}">
        <button class="btn small" type="submit">Search</button>
        {% if q %}
          <a class="btn ghost small" href="{{ url_for('dashboard') }}">Clear</a>
        {% endif %}
      </form>
    </div>

    {% if todos %}
      <ul class="todo-list">
        {% for t in todos %}
          <li class="todo {% if t.done %}done{% endif %}">
            <div class="left">
              <form method="post" action="{{ url_for('toggle_task', task_id=t.id) }}" style="display:inline;">
                <button class="check-btn" title="Toggle done">âœ“</button>
              </form>
              <div class="meta">
                <strong class="title">{{ t.title }}</strong>
                {% if t.due_date %}<div class="dued">Due: {{ t.due_date }}</div>{% endif %}
                {% if t.description %}<div class="desc">{{ t.description }}</div>{% endif %}
              </div>
            </div>

            <div class="actions">
              <a class="btn small" href="{{ url_for('edit_task', task_id=t.id) }}">Edit</a>
              <form method="post" action="{{ url_for('delete_task', task_id=t.id) }}" style="display:inline;" onsubmit="return confirm('Delete task?');">
                <button class="btn danger small" type="submit">Delete</button>
              </form>
            </div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">No tasks yet. Click "New Task" to add one.</p>
    {% endif %}
  </div>
{% endblock %}
